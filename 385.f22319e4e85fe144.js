"use strict";(self.webpackChunkattendance_system=self.webpackChunkattendance_system||[]).push([[385],{2385:(_e,S,c)=>{c.r(S),c.d(S,{DashboardModule:()=>ue});var u=c(6362),d=c(1876),T=c(4770),C=c(4244),t=c(6723),_=c(1130),w=c(2182);c(1631);const L={provide:new t.OlP("mat-select-scroll-strategy"),deps:[C.aV],useFactory:function k(o){return()=>o.scrollStrategies.reposition()}};let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[L],imports:[[u.ez,C.U8,_.Ng,_.BQ],w.ZD,T.lN,_.Ng,_.BQ]}),o})();var P=c(8446),O=c(5693),H=c(1942),B=c(6942),V=c(2218),Z=c(8881),G=c(9054);const j=new class Y extends G.v{}(class U extends Z.o{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}schedule(n,e=0){return e>0?super.schedule(n,e):(this.delay=e,this.state=n,this.scheduler.flush(this),this)}execute(n,e){return e>0||this.closed?super.execute(n,e):this._execute(n,e)}requestAsyncId(n,e,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(n,e,i):n.flush(this)}});var W=c(6957),X=c(3888),z=c(9086),Q=c(1722);class K extends V.xQ{constructor(n=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){if(!this.isStopped){const e=this._events;e.push(n),e.length>this._bufferSize&&e.shift()}super.next(n)}nextTimeWindow(n){this.isStopped||(this._events.push(new q(this._getNow(),n)),this._trimBufferThenGetEvents()),super.next(n)}_subscribe(n){const e=this._infiniteTimeWindow,i=e?this._events:this._trimBufferThenGetEvents(),a=this.scheduler,l=i.length;let r;if(this.closed)throw new z.N;if(this.isStopped||this.hasError?r=W.w.EMPTY:(this.observers.push(n),r=new Q.W(this,n)),a&&n.add(n=new X.ht(n,a)),e)for(let s=0;s<l&&!n.closed;s++)n.next(i[s]);else for(let s=0;s<l&&!n.closed;s++)n.next(i[s].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),r}_getNow(){return(this.scheduler||j).now()}_trimBufferThenGetEvents(){const n=this._getNow(),e=this._bufferSize,i=this._windowTime,a=this._events,l=a.length;let r=0;for(;r<l&&!(n-a[r].time<i);)r++;return l>e&&(r=Math.max(r,l-e)),r>0&&a.splice(0,r),a}}class q{constructor(n,e){this.time=n,this.value=e}}var E=c(8325),M=c(1170);function ee(o,n){(0,M.Z)(2,arguments);var e=(0,E.Z)(o),i=(0,E.Z)(n);return e.getTime()-i.getTime()}function g(o,n){(0,M.Z)(2,arguments);var e=ee(o,n)/6e4;return e>0?Math.floor(e):Math.ceil(e)}var ie=c(7891),ne=c(3512);const oe=["editTimeTpl"];function ae(o,n){if(1&o&&(t.TgZ(0,"p",18),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&o){const e=n.ngIf,i=t.oxw();t.xp6(1),t.AsE(" ",t.xi3(2,2,e,"yyyy-MM-dd")," ",i.weekDay[t.xi3(3,5,e,"EEEE")]," ")}}function se(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1,"\uff08\u7de8\u8f2f\uff09"),t.qZA())}function re(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1,"\uff08\u7de8\u8f2f\uff09"),t.qZA())}function le(o,n){if(1&o&&(t.TgZ(0,"option",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(t.xi3(2,2,e,"2.0"))}}function ce(o,n){if(1&o&&(t.TgZ(0,"option",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(t.xi3(2,2,e,"2.0"))}}function he(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",19)(1,"h5",20),t._uU(2),t.qZA(),t.TgZ(3,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().editTimeDialogRef.close()}),t.TgZ(4,"span",22),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",23)(7,"form",24)(8,"select",25),t.YNc(9,le,3,5,"option",26),t.qZA(),t.TgZ(10,"span"),t._uU(11,"\uff1a"),t.qZA(),t.TgZ(12,"select",27),t.YNc(13,ce,3,5,"option",26),t.qZA()()(),t.TgZ(14,"div",28)(15,"button",29),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().onEditTimeSubmit(l.clockType)}),t._uU(16,"\u9001\u51fa"),t.qZA()()}if(2&o){const e=n.$implicit,i=t.oxw();t.xp6(2),t.hij("\u7de8\u8f2f","IN"===e.clockType?"\u4e0a\u73ed":"\u4e0b\u73ed","\u6253\u5361\u6642\u9593"),t.xp6(5),t.Q6J("formGroup",i.editTimeForm),t.xp6(2),t.Q6J("ngForOf",i.hours),t.xp6(4),t.Q6J("ngForOf",i.minutes)}}const de=[{path:"",component:(()=>{class o{constructor(e,i,a){this.fb=e,this.recordService=i,this.dialog=a,this.className="d-flex justify-content-center pt-2",this.currentTime$=(0,H.H)(0,1e3).pipe((0,B.U)(()=>new Date),function J(o,n,e){let i;return i=o&&"object"==typeof o?o:{bufferSize:o,windowTime:n,refCount:!1,scheduler:e},a=>a.lift(function $({bufferSize:o=Number.POSITIVE_INFINITY,windowTime:n=Number.POSITIVE_INFINITY,refCount:e,scheduler:i}){let a,r,l=0,s=!1,p=!1;return function(y){let m;l++,!a||s?(s=!1,a=new K(o,n,i),m=a.subscribe(this),r=y.subscribe({next(v){a.next(v)},error(v){s=!0,a.error(v)},complete(){p=!0,r=void 0,a.complete()}})):m=a.subscribe(this),this.add(()=>{l--,m.unsubscribe(),r&&!p&&e&&0===l&&(r.unsubscribe(),r=void 0,a=void 0)})}}(i))}(1)),this.form=this.fb.group({remark:[null]}),this.editTimeForm=this.fb.group({hour:[0],minute:[0]}),this.startTime=null,this.endTime=null,this.weekDay={Monday:"\u661f\u671f\u4e00",Tuesday:"\u661f\u671f\u4e8c",Wednesday:"\u661f\u671f\u4e09",Thursday:"\u661f\u671f\u56db",Friday:"\u661f\u671f\u4e94",Saturday:"\u661f\u671f\u516d",Sunday:"\u661f\u671f\u65e5"},this.hours=Array.from({length:24},(l,r)=>r),this.minutes=Array.from({length:60},(l,r)=>r)}ngOnInit(){this.reloadRangeRecord()}reloadRangeRecord(){this.recordService.getRange().subscribe(({startTime:e,endTime:i,remark:a})=>{this.startTime=e,this.endTime=i,this.form.reset({remark:a})})}onSubmit(e){if("OUT"===e&&this.startTime&&!this.endTime&&g(new Date(this.startTime),new Date)>570)return void alert("\u4e0b\u73ed\u6253\u5361\u5982\u679c\u8d85\u904e 9.5 \u5c0f\u6642\uff0c\u5247\u64cb\u8457\u4e0d\u7d66\u6253\u4e0b\u73ed\u5361\uff01");if("IN"===e&&this.startTime||"OUT"===e&&this.endTime)return void this.openEditTimeTpl(e);const i=this.form.get("remark").value;this.recordService.create(i).subscribe(()=>{this.reloadRangeRecord(),alert(`\u4eca\u65e5\u7684${"IN"===e?"\u4e0a\u73ed":"\u4e0b\u73ed"}\u6253\u5361\u6642\u9593\u5df2\u65b0\u589e!!`)})}openEditTimeTpl(e){const i=new Date("IN"===e?this.startTime:this.endTime);this.editTimeForm.reset({hour:i.getHours(),minute:i.getMinutes()}),this.editTimeDialogRef=this.dialog.open(this.editTimeTpl,{clockType:e}),this.editTimeDialogRef.afterClosed$.subscribe(()=>{this.editTimeDialogRef=null})}onEditTimeSubmit(e){const{hour:i,minute:a}=this.editTimeForm.value;let l,r;if("IN"===e){const s=new Date(this.endTime);if(r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),i,a),l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()),g(l,r)<0)return void alert("\u4e0a\u73ed\u6253\u5361\u6642\u9593\u4e0d\u80fd\u5927\u65bc\u4e0b\u73ed\u6253\u5361\u6642\u9593\uff01")}else{const s=new Date(this.startTime);if(l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),i,a),r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()),g(l,r)<0)return void alert("\u4e0b\u73ed\u6253\u5361\u6642\u9593\u4e0d\u80fd\u5c0f\u65bc\u4e0a\u73ed\u6253\u5361\u6642\u9593\uff01")}g(l,r)>570?alert("\u6253\u5361\u6642\u9593\u8d85\u904e 9.5 \u5c0f\u6642\uff0c\u8acb\u91cd\u65b0\u8f38\u5165\uff01"):(this.editTimeDialogRef.close(),alert(`\u4eca\u65e5\u7684${"IN"===e?"\u4e0a\u73ed":"\u4e0b\u73ed"}\u6253\u5361\u6642\u9593\u5df2\u66f4\u65b0!!`))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.qu),t.Y36(ie.B),t.Y36(ne.H))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-dashboard"]],viewQuery:function(e,i){if(1&e&&t.Gf(oe,7),2&e){let a;t.iGM(a=t.CRH())&&(i.editTimeTpl=a.first)}},hostVars:1,hostBindings:function(e,i){2&e&&t.Ikx("className",i.className)},decls:44,vars:28,consts:[[1,"d-flex","flex-column","text-center",3,"formGroup"],["class","fa-2x mb-0 text-white",4,"ngIf"],[1,"fa-5x","font-weight-bold","text-white"],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"align-items-center","d-flex","w-50"],[1,"fa","fa-clock-o","fa-2x","mr-3"],[1,"text-left"],[1,"font-weight-bold"],[1,"w-50","h4","m-0"],[1,"form-group","mt-3","text-left"],["for","remark",1,"h5","text-white"],["id","remark","type","text","formControlName","remark",1,"form-control"],[1,"d-flex"],["type","button",1,"btn","btn-secondary","fa-2x","rounded","w-50",3,"click"],[4,"ngIf"],[1,"flex-fill","p-1"],["editTimeTpl",""],[1,"fa-2x","mb-0","text-white"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"h2","text-center",3,"formGroup"],["formControlName","hour","name","hour"],[3,"value",4,"ngFor","ngForOf"],["formControlName","minute","name","minute"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],[3,"value"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.YNc(1,ae,4,8,"p",1),t.ALo(2,"async"),t.TgZ(3,"p",2),t._uU(4),t.ALo(5,"date"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"ul",3)(8,"li",4)(9,"div",5),t._UZ(10,"i",6),t.TgZ(11,"div",7),t._uU(12," First time "),t._UZ(13,"br"),t.TgZ(14,"span",8),t._uU(15,"\u9996\u6b21\u6253\u5361"),t.qZA()()(),t.TgZ(16,"div",9),t._uU(17),t.ALo(18,"date"),t.qZA()(),t.TgZ(19,"li",4)(20,"div",5),t._UZ(21,"i",6),t.TgZ(22,"div",7),t._uU(23," Last time "),t._UZ(24,"br"),t.TgZ(25,"span",8),t._uU(26,"\u6700\u5f8c\u6253\u5361"),t.qZA()()(),t.TgZ(27,"div",9),t._uU(28),t.ALo(29,"date"),t.qZA()()(),t.TgZ(30,"div",10)(31,"label",11),t._uU(32,"\u5099\u8a3b\uff1a"),t.qZA(),t._UZ(33,"input",12),t.qZA(),t.TgZ(34,"div",13)(35,"button",14),t.NdJ("click",function(){return i.onSubmit("IN")}),t._uU(36," \u4e0a\u73ed\u6253\u5361 "),t.YNc(37,se,2,0,"span",15),t.qZA(),t._UZ(38,"i",16),t.TgZ(39,"button",14),t.NdJ("click",function(){return i.onSubmit("OUT")}),t._uU(40," \u4e0b\u73ed\u6253\u5361 "),t.YNc(41,re,2,0,"span",15),t.qZA()()(),t.YNc(42,he,17,4,"ng-template",null,17,t.W1O)),2&e&&(t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,15,i.currentTime$)),t.xp6(3),t.hij(" ",t.xi3(5,17,t.lcZ(6,20,i.currentTime$),"HH:mm:ss")," "),t.xp6(12),t.ekj("font-weight-bold",i.startTime)("text-black-50",!i.startTime),t.xp6(1),t.hij(" ",i.startTime?t.xi3(18,22,i.startTime,"HH:mm"):"\u5c1a\u672a\u6253\u5361"," "),t.xp6(10),t.ekj("font-weight-bold",i.endTime)("text-black-50",!i.endTime),t.xp6(1),t.hij(" ",i.endTime?t.xi3(29,25,i.endTime,"HH:mm"):"\u5c1a\u672a\u6253\u5361"," "),t.xp6(9),t.Q6J("ngIf",i.startTime),t.xp6(4),t.Q6J("ngIf",i.endTime))},directives:[d._Y,d.JL,d.sg,u.O5,d.Fj,d.JJ,d.u,d.EJ,u.sg,d.YN,d.Kr],pipes:[u.Ov,u.uU,u.JJ],styles:[""]}),o})()}];let pe=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[O.Bz.forChild(de)],O.Bz]}),o})(),ue=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[u.ez,d.u5,d.UX,T.lN,N,P.m,pe]]}),o})()}}]);
//# sourceMappingURL=385.f22319e4e85fe144.js.map