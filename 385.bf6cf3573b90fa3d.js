"use strict";(self.webpackChunkattendance_system=self.webpackChunkattendance_system||[]).push([[385],{2385:(_e,T,c)=>{c.r(T),c.d(T,{DashboardModule:()=>ue});var u=c(6362),d=c(1876),S=c(4770),C=c(4244),e=c(6723),_=c(1130),w=c(2182);c(1631);const L={provide:new e.OlP("mat-select-scroll-strategy"),deps:[C.aV],useFactory:function k(o){return()=>o.scrollStrategies.reposition()}};let N=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[L],imports:[[u.ez,C.U8,_.Ng,_.BQ],w.ZD,S.lN,_.Ng,_.BQ]}),o})();var P=c(8446),O=c(5693),E=c(8325),M=c(1170);function H(o,n){(0,M.Z)(2,arguments);var t=(0,E.Z)(o),i=(0,E.Z)(n);return t.getTime()-i.getTime()}function g(o,n){(0,M.Z)(2,arguments);var t=H(o,n)/6e4;return t>0?Math.floor(t):Math.ceil(t)}var V=c(1942),U=c(6942),Z=c(2218),G=c(8881),Y=c(9054);const X=new class W extends Y.v{}(class j extends G.o{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}schedule(n,t=0){return t>0?super.schedule(n,t):(this.delay=t,this.state=n,this.scheduler.flush(this),this)}execute(n,t){return t>0||this.closed?super.execute(n,t):this._execute(n,t)}requestAsyncId(n,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(n,t,i):n.flush(this)}});var Q=c(6957),z=c(3888),K=c(9086),q=c(1722);class J extends Z.xQ{constructor(n=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){if(!this.isStopped){const t=this._events;t.push(n),t.length>this._bufferSize&&t.shift()}super.next(n)}nextTimeWindow(n){this.isStopped||(this._events.push(new $(this._getNow(),n)),this._trimBufferThenGetEvents()),super.next(n)}_subscribe(n){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),a=this.scheduler,l=i.length;let r;if(this.closed)throw new K.N;if(this.isStopped||this.hasError?r=Q.w.EMPTY:(this.observers.push(n),r=new q.W(this,n)),a&&n.add(n=new z.ht(n,a)),t)for(let s=0;s<l&&!n.closed;s++)n.next(i[s]);else for(let s=0;s<l&&!n.closed;s++)n.next(i[s].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),r}_getNow(){return(this.scheduler||X).now()}_trimBufferThenGetEvents(){const n=this._getNow(),t=this._bufferSize,i=this._windowTime,a=this._events,l=a.length;let r=0;for(;r<l&&!(n-a[r].time<i);)r++;return l>t&&(r=Math.max(r,l-t)),r>0&&a.splice(0,r),a}}class ${constructor(n,t){this.time=n,this.value=t}}var ie=c(7891),ne=c(3512);const oe=["editTimeTpl"];function ae(o,n){if(1&o&&(e.TgZ(0,"p",19),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&o){const t=n.ngIf,i=e.oxw();e.xp6(1),e.AsE(" ",e.xi3(2,2,t,"yyyy-MM-dd")," ",i.weekDay[e.xi3(3,5,t,"EEEE")]," ")}}function se(o,n){1&o&&(e.TgZ(0,"span"),e._uU(1,"\uff08\u7de8\u8f2f\uff09"),e.qZA())}function re(o,n){1&o&&(e.TgZ(0,"span"),e._uU(1,"\uff08\u7de8\u8f2f\uff09"),e.qZA())}function le(o,n){if(1&o&&(e.TgZ(0,"option",31),e._uU(1),e.ALo(2,"number"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(e.xi3(2,2,t,"2.0"))}}function ce(o,n){if(1&o&&(e.TgZ(0,"option",31),e._uU(1),e.ALo(2,"number"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(e.xi3(2,2,t,"2.0"))}}function he(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",20)(1,"h5",21),e._uU(2),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().editTimeDialogRef.close()}),e.TgZ(4,"span",23),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",24)(7,"form",25)(8,"select",26),e.YNc(9,le,3,5,"option",27),e.qZA(),e.TgZ(10,"span"),e._uU(11,"\uff1a"),e.qZA(),e.TgZ(12,"select",28),e.YNc(13,ce,3,5,"option",27),e.qZA()()(),e.TgZ(14,"div",29)(15,"button",30),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().onEditTimeSubmit(l.clockType)}),e._uU(16,"\u9001\u51fa"),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw();e.xp6(2),e.hij("\u7de8\u8f2f","IN"===t.clockType?"\u4e0a\u73ed":"\u4e0b\u73ed","\u6253\u5361\u6642\u9593"),e.xp6(5),e.Q6J("formGroup",i.editTimeForm),e.xp6(2),e.Q6J("ngForOf",i.hours),e.xp6(4),e.Q6J("ngForOf",i.minutes)}}const de=[{path:"",component:(()=>{class o{constructor(t,i,a){this.fb=t,this.recordService=i,this.dialog=a,this.className="d-flex justify-content-center pt-2",this.currentTime$=(0,V.H)(0,1e3).pipe((0,U.U)(()=>new Date),function ee(o,n,t){let i;return i=o&&"object"==typeof o?o:{bufferSize:o,windowTime:n,refCount:!1,scheduler:t},a=>a.lift(function te({bufferSize:o=Number.POSITIVE_INFINITY,windowTime:n=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let a,r,l=0,s=!1,p=!1;return function(y){let m;l++,!a||s?(s=!1,a=new J(o,n,i),m=a.subscribe(this),r=y.subscribe({next(v){a.next(v)},error(v){s=!0,a.error(v)},complete(){p=!0,r=void 0,a.complete()}})):m=a.subscribe(this),this.add(()=>{l--,m.unsubscribe(),r&&!p&&t&&0===l&&(r.unsubscribe(),r=void 0,a=void 0)})}}(i))}(1)),this.form=this.fb.group({remark:[null]}),this.editTimeForm=this.fb.group({hour:[0],minute:[0]}),this.startTime=null,this.endTime=null,this.weekDay={Monday:"\u661f\u671f\u4e00",Tuesday:"\u661f\u671f\u4e8c",Wednesday:"\u661f\u671f\u4e09",Thursday:"\u661f\u671f\u56db",Friday:"\u661f\u671f\u4e94",Saturday:"\u661f\u671f\u516d",Sunday:"\u661f\u671f\u65e5"},this.hours=Array.from({length:24},(l,r)=>r),this.minutes=Array.from({length:60},(l,r)=>r)}ngOnInit(){this.reloadRangeRecord()}reloadRangeRecord(){this.recordService.getRange().subscribe(({startTime:t,endTime:i,remark:a})=>{this.startTime=t,this.endTime=i,this.form.reset({remark:a}),alert(`\u4eca\u65e5\u7684\u4e0a\u73ed\u6253\u5361\u6642\u9593\u70ba ${t}\uff0c\u4e0b\u73ed\u6253\u5361\u6642\u9593\u70ba ${i}\uff0c\u5099\u8a3b\u70ba ${a}`)})}onSubmit(t){if("OUT"===t&&this.startTime&&!this.endTime&&g(new Date(this.startTime),new Date)>570)return void alert("\u4e0b\u73ed\u6253\u5361\u5982\u679c\u8d85\u904e 9.5 \u5c0f\u6642\uff0c\u5247\u64cb\u8457\u4e0d\u7d66\u6253\u4e0b\u73ed\u5361\uff01");if("IN"===t&&this.startTime||"OUT"===t&&this.endTime)return void this.openEditTimeTpl(t);const i=this.form.get("remark").value;this.recordService.create(i).subscribe(()=>{this.reloadRangeRecord(),alert(`\u4eca\u65e5\u7684${"IN"===t?"\u4e0a\u73ed":"\u4e0b\u73ed"}\u6253\u5361\u6642\u9593\u5df2\u65b0\u589e!!`)})}openEditTimeTpl(t){const i=new Date("IN"===t?this.startTime:this.endTime);this.editTimeForm.reset({hour:i.getHours(),minute:i.getMinutes()}),this.editTimeDialogRef=this.dialog.open(this.editTimeTpl,{clockType:t}),this.editTimeDialogRef.afterClosed$.subscribe(()=>{this.editTimeDialogRef=null})}onEditTimeSubmit(t){const{hour:i,minute:a}=this.editTimeForm.value;let l,r;if("IN"===t){const s=new Date(this.endTime);if(r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),i,a),l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()),g(l,r)<0)return void alert("\u4e0a\u73ed\u6253\u5361\u6642\u9593\u4e0d\u80fd\u5927\u65bc\u4e0b\u73ed\u6253\u5361\u6642\u9593\uff01")}else{const s=new Date(this.startTime);if(l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),i,a),r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()),g(l,r)<0)return void alert("\u4e0b\u73ed\u6253\u5361\u6642\u9593\u4e0d\u80fd\u5c0f\u65bc\u4e0a\u73ed\u6253\u5361\u6642\u9593\uff01")}g(l,r)>570?alert("\u6253\u5361\u6642\u9593\u8d85\u904e 9.5 \u5c0f\u6642\uff0c\u8acb\u91cd\u65b0\u8f38\u5165\uff01"):(this.editTimeDialogRef.close(),alert(`\u4eca\u65e5\u7684${"IN"===t?"\u4e0a\u73ed":"\u4e0b\u73ed"}\u6253\u5361\u6642\u9593\u5df2\u66f4\u65b0!!`))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.qu),e.Y36(ie.B),e.Y36(ne.H))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(1&t&&e.Gf(oe,7),2&t){let a;e.iGM(a=e.CRH())&&(i.editTimeTpl=a.first)}},hostVars:1,hostBindings:function(t,i){2&t&&e.Ikx("className",i.className)},decls:54,vars:39,consts:[[1,"d-flex","flex-column","text-center",3,"formGroup"],["class","fa-2x mb-0 text-white",4,"ngIf"],[1,"fa-5x","font-weight-bold","text-white"],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"align-items-center","d-flex","w-50"],[1,"fa","fa-clock-o","fa-2x","mr-3"],[1,"text-left"],[1,"font-weight-bold"],[1,"w-50","h4","m-0"],[1,"form-group","mt-3","text-left"],["for","remark",1,"h5","text-white"],["id","remark","type","text","formControlName","remark",1,"form-control"],[1,"d-flex"],["type","button",1,"btn","btn-secondary","fa-2x","rounded","w-50",3,"click"],[4,"ngIf"],[1,"flex-fill","p-1"],["type","button",1,"btn","btn-secondary","fa-2x","rounded","w-50",3,"disabled","click"],["editTimeTpl",""],[1,"fa-2x","mb-0","text-white"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"h2","text-center",3,"formGroup"],["formControlName","hour","name","hour"],[3,"value",4,"ngFor","ngForOf"],["formControlName","minute","name","minute"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0),e.YNc(1,ae,4,8,"p",1),e.ALo(2,"async"),e.TgZ(3,"p",2),e._uU(4),e.ALo(5,"date"),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"ul",3)(8,"li",4)(9,"div",5),e._UZ(10,"i",6),e.TgZ(11,"div",7),e._uU(12," First time "),e._UZ(13,"br"),e.TgZ(14,"span",8),e._uU(15,"\u9996\u6b21\u6253\u5361"),e.qZA()()(),e.TgZ(16,"div",9),e._uU(17),e.ALo(18,"date"),e._UZ(19,"br"),e._uU(20),e._UZ(21,"br"),e._uU(22),e.ALo(23,"date"),e.qZA()(),e.TgZ(24,"li",4)(25,"div",5),e._UZ(26,"i",6),e.TgZ(27,"div",7),e._uU(28," Last time "),e._UZ(29,"br"),e.TgZ(30,"span",8),e._uU(31,"\u6700\u5f8c\u6253\u5361"),e.qZA()()(),e.TgZ(32,"div",9),e._uU(33),e.ALo(34,"date"),e._UZ(35,"br"),e._uU(36),e._UZ(37,"br"),e._uU(38),e.ALo(39,"date"),e.qZA()()(),e.TgZ(40,"div",10)(41,"label",11),e._uU(42,"\u5099\u8a3b\uff1a"),e.qZA(),e._UZ(43,"input",12),e.qZA(),e.TgZ(44,"div",13)(45,"button",14),e.NdJ("click",function(){return i.onSubmit("IN")}),e._uU(46," \u4e0a\u73ed\u6253\u5361 "),e.YNc(47,se,2,0,"span",15),e.qZA(),e._UZ(48,"i",16),e.TgZ(49,"button",17),e.NdJ("click",function(){return i.onSubmit("OUT")}),e._uU(50," \u4e0b\u73ed\u6253\u5361 "),e.YNc(51,re,2,0,"span",15),e.qZA()()(),e.YNc(52,he,17,4,"ng-template",null,18,e.W1O)),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,20,i.currentTime$)),e.xp6(3),e.hij(" ",e.xi3(5,22,e.lcZ(6,25,i.currentTime$),"HH:mm:ss")," "),e.xp6(12),e.ekj("font-weight-bold",i.startTime)("text-black-50",!i.startTime),e.xp6(1),e.hij(" ",i.startTime?e.xi3(18,27,i.startTime,"HH:mm"):"\u5c1a\u672a\u6253\u5361"," "),e.xp6(3),e.hij(" ",i.startTime," "),e.xp6(2),e.hij(" ",e.xi3(23,30,i.startTime,"HH:mm")," "),e.xp6(10),e.ekj("font-weight-bold",i.endTime)("text-black-50",!i.endTime),e.xp6(1),e.hij(" ",i.endTime?e.xi3(34,33,i.endTime,"HH:mm"):"\u5c1a\u672a\u6253\u5361"," "),e.xp6(3),e.hij(" ",i.endTime," "),e.xp6(2),e.hij(" ",e.xi3(39,36,i.endTime,"HH:mm")," "),e.xp6(9),e.Q6J("ngIf",i.startTime),e.xp6(2),e.Q6J("disabled",!i.startTime),e.xp6(2),e.Q6J("ngIf",i.endTime))},directives:[d._Y,d.JL,d.sg,u.O5,d.Fj,d.JJ,d.u,d.EJ,u.sg,d.YN,d.Kr],pipes:[u.Ov,u.uU,u.JJ],styles:[""]}),o})()}];let pe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[O.Bz.forChild(de)],O.Bz]}),o})(),ue=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[u.ez,d.u5,d.UX,S.lN,N,P.m,pe]]}),o})()}}]);
//# sourceMappingURL=385.bf6cf3573b90fa3d.js.map